# 앙상블 모델
## 앙상블(프랑스어 Ensemble)
앙상블의 의미는 아래와 같다.
- 전체적인 어울림이나 통일
- 드레스와 코트, 스커트와 재킷 따위를 같은 천으로 만들어서 서로 잘 어울리는 한 벌의 여성복
- 음악 2인 이상이 하는 노래나 연주
- 음악 주로 실내악을 연주하는 적은 인원의 합주단
- 연기 배우 전원의 협력에 의하여 통일적인 효과를 얻으려는 연출법

즉 "함께" 조화를 이루어 하는 일을 의미한다.

## 앙상블 방법론
최근 기계학습 분야에서 딥러닝이외에 부스팅(boosting) 알고리즘이 자주 사용된다.
- 딥러닝은 비싸기 때문에 성능이 좋고 가벼운 모델을 만들려면 작은 모델을 사용해야 한다.

선형회귀나 로지스틱 회귀는 가장 쉽고 대중적인 알고리즘이다.

그 다음이 의사결정트리, 앙상블 계열 알고리즘, 딥러닝 등등이다.

## 앙상블
여러 개의 알고리즘들이 하나의 값을 예측하는 기법을 통칭하여 말한다.
- 회귀 문제에서는 가중 평균이나 단순 평균을 구하는 방식으로 y 값을 예측한다.

메타 분류기(meta - classifier)라고도 부른다.
- 메타(meta)는 일종의 상위 또는 추상화라는 개념이다.
- 여러 분류기들을 모아 하나의 분류기를 만들어 이를 메타 분류기라고 부른다.

시간이 굉장히 오래 걸리지만 비교적 좋은 성능을 보인다.
- "오래"라고 해도 대부분의 딥러닝 모델보다는 가볍다.

### 앙상블 모델

1. 하나의 데이터를 넣는다.
2. 이를 여러 모델이 학습한다.
3. 테스트 데이터를 각 모델에 입력한다.
4. 투표 또는 여러 가중치 기법을 적용하여 최종 선택한다.

<img width="392" alt="image" src="https://github.com/user-attachments/assets/9316e369-3819-4c1c-8265-eb5c059c3d6f">

## 앙상블 기법들
### 바닐라 앙상블
가장 기본적인 앙상블 기법이다.

바닐라 앙상블은 아무것도 처리하지 않은 앙상블 모델을 의미한다.

일반적으로 가중치 평균이나 투표 방식으로 만들어지는 앙상블 모델이다.

### 부스팅
하나의 모델에서 여러 데이터를 샘플링한 다음 그 샘플링된 데이터로 각각의 모델을 만드는 기법이다.

### 배깅
boosting aggregation(부스팅 집합)의 줄임말으로 부스팅을 좀 더 발전시킨 기법이다.

## 투표 분류기(Voting Classifier)
여러 개의 모델을 만들어 모두 같은 데이터를 넣고 결과를 취합하여 가장 많이 선택된 결과를 취한다.

<img width="355" alt="image" src="https://github.com/user-attachments/assets/fcebe866-9411-4138-9db7-d36ba2e247a5">

앙상블 모델의 가장 기본적인 형태이다.

다수결 분류기(majority voting classifier)라고도 부른다.

또는 각 분류기마다 가중치를 주고 해당 가중치를 각 모델에 곱하여 가중치의 합을 구하는 방식도 있다.

다양한 모델을 만든 후, 다음 단계로 매우 쉽게 만들 수 있다는 장점이 있다.
- 있는 모델을 결합만 하면 된다.

## 배깅(Bagging)
하나의 데이터셋에서 샘플링을 통해 여러 개의 데이터셋을 만든 다음 각 데이터셋마다 모델을 개발하여 투표 분류기로 만드는 기법이다.
- 단순하면서 성능이 높아 특히 트리 계열 알고리즘과 함께 많이 사용되며 통계적인 샘플링 기법이나 딥러닝 기법과도 함께 사용된다.

### 샘플링(Sampling)
다루고자 하는 데이터가 전체 모수라면 그 모수에서 일부분을 뽑아서 데이터를 분석하는 방법이다.

### 배깅의 장점
다양한 데이터셋에서 강건한 모델(robust model)을 개발할 수 있다.

<img width="573" alt="image" src="https://github.com/user-attachments/assets/645d0d86-15cc-4cb2-825d-d9a3234e9157">
